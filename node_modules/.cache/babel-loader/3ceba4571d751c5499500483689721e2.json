{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/terry/UUBC/React/Chess/src/components/game.js\";\n\n/* eslint-disable no-unused-expressions */\nimport React from 'react';\nimport '../index.css';\nimport Board from './board.js';\nimport FallenSoldierBlock from './fallensoldiers';\nimport initialiseChessBoard from '../helpers/initialiseChessBoard';\nimport Queen from '../pieces/queen';\nimport Knight from '../pieces/knight';\nimport Bishop from '../pieces/bishop';\nimport Rook from '../pieces/rook';\nexport default class Game extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      squares: initialiseChessBoard(),\n      whiteFallenSoldiers: [],\n      blackFallenSoldiers: [],\n      player: 1,\n      sourceSelection: -1,\n      status: '',\n      turn: 'white',\n      white: 2,\n      black: 2,\n      lastTurnPawnPosition: undefined,\n      //firstMove true === last turn enemy's pawn moved for the first time and it moved 2 squares forward. for en pasaant\n      firstMove: undefined,\n      highLightMoves: [],\n      //for castle\n      allPossibleMovesWhite: [],\n      allPossibleMovesBlack: [],\n      whiteKingFirstMove: true,\n      blackKingFirstMove: true,\n      whiteRookFirstMoveLeft: true,\n      whiteRookFirstMoveRight: true,\n      blackRookFirstMoveLeft: true,\n      blackRookFirstMoveRight: true,\n      //record king's position\n      whiteKingPosition: 60,\n      blackKingPosition: 4,\n      //convert pawn\n      tempSquares: [],\n      convertPawnPosition: undefined,\n      //new game button\n      disabled: false,\n      hideButton: \"none\"\n    };\n  }\n\n  handleClick(i) {\n    let squares = this.state.squares;\n    let white = this.state.white;\n    let black = this.state.black;\n\n    if (i.cancelable) {\n      //reset game\n      this.setState({\n        squares: initialiseChessBoard(),\n        whiteFallenSoldiers: [],\n        blackFallenSoldiers: [],\n        player: 1,\n        sourceSelection: -1,\n        status: '',\n        turn: 'white',\n        white: 16,\n        black: 16,\n        lastTurnPawnPosition: undefined,\n        firstMove: undefined,\n        highLightMoves: [],\n        allPossibleMovesWhite: [],\n        allPossibleMovesBlack: [],\n        whiteKingFirstMove: true,\n        blackKingFirstMove: true,\n        whiteRookFirstMoveLeft: true,\n        whiteRookFirstMoveRight: true,\n        blackRookFirstMoveLeft: true,\n        blackRookFirstMoveRight: true,\n        whiteKingPosition: 60,\n        blackKingPosition: 4,\n        tempSquares: [],\n        convertPawnPosition: undefined,\n        disabled: false,\n        hideButton: \"none\"\n      });\n    } else if (this.state.sourceSelection === -1) {\n      let highLightMoves = [];\n\n      if (!squares[i] || squares[i].player !== this.state.player) {\n        this.setState({\n          status: \"Wrong selection. Choose player \" + this.state.player + \" pieces.\"\n        });\n        squares[i] ? squares[i].style = { ...squares[i].style,\n          backgroundColor: \"\"\n        } : null;\n      } else {\n        //highlight selected piece\n        squares[i].style = { ...squares[i].style,\n          backgroundColor: \"RGB(111,143,114)\"\n        }; // Emerald from http://omgchess.blogspot.com/2015/09/chess-board-color-schemes.html\n        //check if castle is possible and add possible moves to highLightMoves array\n\n        if (i === 4 || i === 60) {\n          if (this.state.turn === \"white\" && this.state.whiteKingFirstMove) {\n            if (this.state.whiteRookFirstMoveLeft && squares[57] === null && squares[58] === null && squares[59] === null && !this.state.allPossibleMovesBlack.some(element => [57, 58, 59].includes(element))) {\n              highLightMoves.push(58);\n            }\n\n            if (this.state.whiteRookFirstMoveRight && squares[61] === null && squares[62] === null && !this.state.allPossibleMovesBlack.some(element => [61, 62].includes(element))) {\n              highLightMoves.push(62);\n            }\n          } else if (this.state.turn === \"black\" && this.state.blackKingFirstMove) {\n            if (this.state.blackRookFirstMoveLeft && squares[1] === null && squares[2] === null && squares[3] === null && !this.state.allPossibleMovesWhite.some(element => [1, 2, 3].includes(element))) {\n              highLightMoves.push(2);\n            }\n\n            if (this.state.blackRookFirstMoveRight && squares[5] === null && squares[6] === null && !this.state.allPossibleMovesWhite.some(element => [5, 6].includes(element))) {\n              highLightMoves.push(6);\n            }\n          }\n        } //highlight possible moves\n\n\n        if (squares[i].name === \"Pawn\") {\n          const enpassant = this.enpassant(i);\n          highLightMoves = this.checkMovesVer2(squares, squares[i].possibleMoves(i, squares, enpassant, this.state.lastTurnPawnPosition), i, this.state.turn);\n        } else if (squares[i].name === \"King\") {\n          highLightMoves = highLightMoves.concat(squares[i].possibleMoves(i, squares));\n          highLightMoves = this.checkMovesVer2(squares, highLightMoves, i, this.state.turn);\n        } else {\n          highLightMoves = this.checkMovesVer2(squares, squares[i].possibleMoves(i, squares), i, this.state.turn);\n        }\n\n        for (let index = 0; index < highLightMoves.length; index++) {\n          const element = highLightMoves[index];\n\n          if (squares[element] !== null) {\n            squares[element].style = { ...squares[element].style,\n              backgroundColor: \"RGB(111,143,114)\"\n            };\n          } else {\n            squares.splice(element, 1, {\n              style: {\n                backgroundColor: \"RGB(111,143,114)\"\n              }\n            });\n          }\n        }\n\n        this.setState({\n          squares: squares,\n          status: \"Choose destination for the selected piece\",\n          sourceSelection: i,\n          highLightMoves: highLightMoves\n        });\n      }\n    } else if (this.state.sourceSelection === -2) {\n      //to convert pawn that reach other side of the chess board\n      if ([10, 11, 12, 13, 50, 51, 52, 53].includes(i)) {\n        //dehighlight\n        if (this.state.turn === \"black\") {\n          squares[10].style = { ...squares[10].style,\n            backgroundColor: \"\"\n          };\n          squares[11].style = { ...squares[11].style,\n            backgroundColor: \"\"\n          };\n          squares[12].style = { ...squares[12].style,\n            backgroundColor: \"\"\n          };\n          squares[13].style = { ...squares[13].style,\n            backgroundColor: \"\"\n          };\n        } else if (this.state.turn === \"white\") {\n          squares[50].style = { ...squares[50].style,\n            backgroundColor: \"\"\n          };\n          squares[51].style = { ...squares[51].style,\n            backgroundColor: \"\"\n          };\n          squares[52].style = { ...squares[52].style,\n            backgroundColor: \"\"\n          };\n          squares[53].style = { ...squares[53].style,\n            backgroundColor: \"\"\n          };\n        } //convert pawn to player selected piece\n\n\n        const newSquares = this.state.tempSquares;\n        newSquares[this.state.convertPawnPosition] = squares[i];\n        this.setState({\n          squares: newSquares,\n          status: \"\",\n          convertPawnPosition: undefined,\n          sourceSelection: -1\n        });\n      } else {\n        this.wrongMove(squares, \"Wrong selection. Choose valid source and destination again.\");\n      }\n    } else if (this.state.sourceSelection > -1) {\n      //dehighlight selected piece\n      squares[this.state.sourceSelection].style = { ...squares[this.state.sourceSelection].style,\n        backgroundColor: \"\"\n      };\n      const whiteFallenSoldiers = this.state.whiteFallenSoldiers;\n      const blackFallenSoldiers = this.state.blackFallenSoldiers;\n\n      if (squares[this.state.sourceSelection].name === \"Pawn\") {\n        squares = this.dehighlight(squares);\n        const enpassant = this.enpassant(this.state.sourceSelection);\n\n        if (this.state.highLightMoves.includes(i)) {\n          //if en passant is available and player decided to use it, else proceed without it\n          if (enpassant && squares[i] == null && (this.state.lastTurnPawnPosition - 8 === i || this.state.lastTurnPawnPosition + 8 === i)) {\n            //add captured piece to fallen soldier list\n            if (squares[this.state.lastTurnPawnPosition].player === 1) {\n              whiteFallenSoldiers.push(squares[this.state.lastTurnPawnPosition]);\n              white = white - 1;\n            } else {\n              blackFallenSoldiers.push(squares[this.state.lastTurnPawnPosition]);\n              black = black - 1;\n            } //move player selected piece to target position\n\n\n            squares[i] = squares[this.state.sourceSelection];\n            squares[this.state.lastTurnPawnPosition] = null;\n            squares[this.state.sourceSelection] = null; //update the possible moves in order to check if next player can castle or not\n\n            const allPossibleMovesWhite = this.allPossibleMovesWhite(squares);\n            const allPossibleMovesBlack = this.allPossibleMovesBlack(squares);\n            this.changeTurn();\n            this.setState({\n              sourceSelection: -1,\n              squares: squares,\n              whiteFallenSoldiers: whiteFallenSoldiers,\n              blackFallenSoldiers: blackFallenSoldiers,\n              status: '',\n              highLightMoves: [],\n              allPossibleMovesWhite: allPossibleMovesWhite,\n              allPossibleMovesBlack: allPossibleMovesBlack\n            });\n          } else {\n            //check if current pawn is moving for the first time and moving 2 squares forward\n            let firstMove;\n\n            if (squares[this.state.sourceSelection].name === \"Pawn\") {\n              if (squares[this.state.sourceSelection].player === 1 && i === this.state.sourceSelection - 16) {\n                firstMove = true;\n              } else if (squares[this.state.sourceSelection].player === 2 && i === this.state.sourceSelection + 16) {\n                firstMove = true;\n              }\n            } //record current pawn position for next turn to check en passant rule\n\n\n            let lastTurnPawnPosition = i; //update number of pieces\n\n            if (squares[i] !== null) {\n              if (this.state.turn === \"white\") {\n                black = black - 1;\n              } else {\n                white = white - 1;\n              }\n            }\n\n            this.addToFallenSoldierList(i, squares, whiteFallenSoldiers, blackFallenSoldiers);\n            squares = this.movePiece(i, squares, this.state.sourceSelection);\n            this.changeTurn(); //update the possible moves in order to check if next player can castle or not\n\n            const allPossibleMovesWhite = this.allPossibleMovesWhite(squares);\n            const allPossibleMovesBlack = this.allPossibleMovesBlack(squares); //to convert pawn that reach other side of the chess board\n\n            if ([0, 1, 2, 3, 4, 5, 6, 7, 56, 57, 58, 59, 60, 61, 62, 63].includes(i)) {\n              const tempSquares = squares.concat(); //give player choice to convert their pawn and highlight those choices\n\n              if (this.state.turn === \"white\") {\n                tempSquares[10] = new Knight(1);\n                tempSquares[10].style = { ...tempSquares[10].style,\n                  backgroundColor: \"RGB(111,143,114)\"\n                };\n                tempSquares[11] = new Bishop(1);\n                tempSquares[11].style = { ...tempSquares[11].style,\n                  backgroundColor: \"RGB(111,143,114)\"\n                };\n                tempSquares[12] = new Rook(1);\n                tempSquares[12].style = { ...tempSquares[12].style,\n                  backgroundColor: \"RGB(111,143,114)\"\n                };\n                tempSquares[13] = new Queen(1);\n                tempSquares[13].style = { ...tempSquares[13].style,\n                  backgroundColor: \"RGB(111,143,114)\"\n                };\n              } else if (this.state.turn === \"black\") {\n                tempSquares[50] = new Knight(2);\n                tempSquares[50].style = { ...tempSquares[50].style,\n                  backgroundColor: \"RGB(111,143,114)\"\n                };\n                tempSquares[51] = new Bishop(2);\n                tempSquares[51].style = { ...tempSquares[51].style,\n                  backgroundColor: \"RGB(111,143,114)\"\n                };\n                tempSquares[52] = new Rook(2);\n                tempSquares[52].style = { ...tempSquares[52].style,\n                  backgroundColor: \"RGB(111,143,114)\"\n                };\n                tempSquares[53] = new Queen(2);\n                tempSquares[53].style = { ...tempSquares[53].style,\n                  backgroundColor: \"RGB(111,143,114)\"\n                };\n              } //update chess board with convert choices and save chess board without choices in this.state.tempSquares\n\n\n              this.setState({\n                sourceSelection: -2,\n                tempSquares: squares,\n                squares: tempSquares,\n                status: \"\",\n                highLightMoves: [],\n                convertPawnPosition: i\n              });\n            } else {\n              this.setState({\n                sourceSelection: -1,\n                squares: squares,\n                status: \"\",\n                firstMove: firstMove,\n                lastTurnPawnPosition: lastTurnPawnPosition,\n                highLightMoves: [],\n                allPossibleMovesWhite: allPossibleMovesWhite,\n                allPossibleMovesBlack: allPossibleMovesBlack\n              });\n            }\n          }\n        } else {\n          this.wrongMove(squares, \"Wrong selection. Choose valid source and destination again.\");\n        }\n      } else if (squares[this.state.sourceSelection].name === \"King\") {\n        squares = this.dehighlight(squares); //for castling\n\n        if (this.state.highLightMoves.includes(i) && (i === 2 || i === 6 || i === 58 || i === 62) && (this.state.whiteKingFirstMove || this.state.blackKingFirstMove)) {\n          if (i === 58) {\n            squares = this.movePiece(i, squares, this.state.sourceSelection);\n            squares = this.movePiece(59, squares, 56);\n          }\n\n          if (i === 62) {\n            squares = this.movePiece(i, squares, this.state.sourceSelection);\n            squares = this.movePiece(61, squares, 63);\n          }\n\n          if (i === 2) {\n            squares = this.movePiece(i, squares, this.state.sourceSelection);\n            squares = this.movePiece(3, squares, 0);\n          }\n\n          if (i === 6) {\n            squares = this.movePiece(i, squares, this.state.sourceSelection);\n            squares = this.movePiece(5, squares, 7);\n          } //to record king has been moved or not. for castle\n\n\n          let whiteKingFirstMove = this.state.whiteKingFirstMove;\n          let blackKingFirstMove = this.state.blackKingFirstMove;\n\n          if (squares[i].name === \"King\" && this.state.sourceSelection === 60 && squares[i].player === 1) {\n            whiteKingFirstMove = false;\n          }\n\n          if (squares[i].name === \"King\" && this.state.sourceSelection === 4 && squares[i].player === 2) {\n            blackKingFirstMove = false;\n          }\n\n          this.kingPosition(i);\n          this.changeTurn();\n          this.setState({\n            sourceSelection: -1,\n            squares: squares,\n            status: '',\n            highLightMoves: [],\n            whiteKingFirstMove: whiteKingFirstMove,\n            blackKingFirstMove: blackKingFirstMove\n          });\n        } else if (this.state.highLightMoves.includes(i)) {\n          //update number of pieces\n          if (squares[i] !== null) {\n            if (this.state.turn === \"white\") {\n              black = black - 1;\n            } else {\n              white = white - 1;\n            }\n          }\n\n          this.addToFallenSoldierList(i, squares, whiteFallenSoldiers, blackFallenSoldiers);\n          squares = this.movePiece(i, squares, this.state.sourceSelection);\n          this.kingPosition(i);\n          this.changeTurn(); //to record king has been moved or not. for castle\n\n          let whiteKingFirstMove = this.state.whiteKingFirstMove;\n          let blackKingFirstMove = this.state.blackKingFirstMove;\n\n          if (squares[i].name === \"King\" && this.state.sourceSelection === 60 && squares[i].player === 1) {\n            whiteKingFirstMove = false;\n          }\n\n          if (squares[i].name === \"King\" && this.state.sourceSelection === 4 && squares[i].player === 2) {\n            blackKingFirstMove = false;\n          }\n\n          this.setState({\n            sourceSelection: -1,\n            squares: squares,\n            status: '',\n            highLightMoves: [],\n            whiteKingFirstMove: whiteKingFirstMove,\n            blackKingFirstMove: blackKingFirstMove\n          });\n        } else {\n          this.wrongMove(squares, \"Wrong selection. Choose valid source and destination again.\");\n        }\n      } else {\n        squares = this.dehighlight(squares);\n\n        if (this.state.highLightMoves.includes(i)) {\n          //update number of pieces\n          if (squares[i] !== null) {\n            if (this.state.turn === \"white\") {\n              black = black - 1;\n            } else {\n              white = white - 1;\n            }\n          }\n\n          this.addToFallenSoldierList(i, squares, whiteFallenSoldiers, blackFallenSoldiers);\n          squares = this.movePiece(i, squares, this.state.sourceSelection);\n          this.changeTurn(); //to record if rook has been moved or not. for castle.\n\n          let whiteRookFirstMoveLeft = this.state.whiteRookFirstMoveLeft;\n          let whiteRookFirstMoveRight = this.state.whiteRookFirstMoveRight;\n          let blackRookFirstMoveLeft = this.state.blackRookFirstMoveLeft;\n          let blackRookFirstMoveRight = this.state.blackRookFirstMoveRight;\n\n          if (squares[i].name === \"Rook\" && this.state.sourceSelection === 56 && squares[i].player === 1) {\n            whiteRookFirstMoveLeft = false;\n          }\n\n          if (squares[i].name === \"Rook\" && this.state.sourceSelection === 63 && squares[i].player === 1) {\n            whiteRookFirstMoveRight = false;\n          }\n\n          if (squares[i].name === \"Rook\" && this.state.sourceSelection === 0 && squares[i].player === 2) {\n            blackRookFirstMoveLeft = false;\n          }\n\n          if (squares[i].name === \"Rook\" && this.state.sourceSelection === 7 && squares[i].player === 2) {\n            blackRookFirstMoveRight = false;\n          } //update the possible moves in order to check if next player can castle or not\n\n\n          const allPossibleMovesWhite = this.allPossibleMovesWhite(squares);\n          const allPossibleMovesBlack = this.allPossibleMovesBlack(squares);\n          this.setState({\n            sourceSelection: -1,\n            squares: squares,\n            status: '',\n            highLightMoves: [],\n            whiteRookFirstMoveLeft: whiteRookFirstMoveLeft,\n            whiteRookFirstMoveRight: whiteRookFirstMoveRight,\n            blackRookFirstMoveLeft: blackRookFirstMoveLeft,\n            blackRookFirstMoveRight: blackRookFirstMoveRight,\n            allPossibleMovesWhite: allPossibleMovesWhite,\n            allPossibleMovesBlack: allPossibleMovesBlack\n          });\n        } else {\n          this.wrongMove(squares, \"Wrong selection. Choose valid source and destination again.\");\n        }\n      } //to record next player's possible moves\n\n\n      let temp = [];\n      const turn = this.state.turn === \"white\" ? \"black\" : \"white\";\n      const player = this.state.turn === \"white\" ? 2 : 1;\n\n      for (let i = 0; i < squares.length; i++) {\n        if (squares[i] !== null) {\n          if (squares[i].player === player) {\n            if (squares[i].name === \"Pawn\") {\n              temp = temp.concat(this.checkMovesVer2(squares, squares[i].possibleMoves(i, squares), i, turn));\n            } else if (squares[i].name === \"King\") {\n              temp = temp.concat(this.checkMovesVer2(squares, squares[i].possibleMoves(i, squares), i, turn));\n            } else {\n              temp = temp.concat(this.checkMovesVer2(squares, squares[i].possibleMoves(i, squares), i, turn));\n            }\n          }\n        }\n      }\n\n      const kingPosition = turn === \"white\" ? this.state.whiteKingPosition : this.state.blackKingPosition; //if next play doesn't have any possible moves then winner or stalemate\n\n      if (temp.length === 0) {\n        if (!squares[i].possibleMoves(i, squares).includes(kingPosition)) {\n          this.setState({\n            disabled: true,\n            status: \"Stalemate Draw\",\n            hideButton: \"\"\n          });\n        } else {\n          const status = turn === \"white\" ? \"Black Won\" : \"White Won\";\n          this.setState({\n            disabled: true,\n            status: status,\n            hideButton: \"\"\n          });\n        }\n      } //other ways to draw\n\n\n      if (black < 3 && white < 3) {\n        let temp = undefined;\n        let temp2 = false;\n\n        for (let i = 0; i < squares.length; i++) {\n          if (squares[i] !== null) {\n            if (squares[i].name === \"Bishop\") {\n              if ([1, 3, 5, 7, 8, 10, 12, 14, 17, 19, 21, 23, 24, 26, 28, 30, 33, 35, 37, 39, 40, 42, 44, 46, 49, 51, 53, 55, 56, 58, 60, 62].includes(i)) {\n                if (squares[i].player === 1) {\n                  temp = true;\n                } else {\n                  temp2 = true;\n                }\n              } else {\n                console.log(i);\n\n                if (squares[i].player === 1) {\n                  temp = false;\n                } else {\n                  temp2 = false;\n                }\n              }\n            }\n          }\n        } //king and bishop versus king and bishop with the bishops on the same color\n\n\n        if (temp === temp2) {\n          this.setState({\n            disabled: true,\n            status: \"Draw\",\n            hideButton: \"\"\n          });\n        }\n\n        console.log(black);\n        console.log(white); //king versus king draw\n\n        if (black === white === 1) {\n          this.setState({\n            disabled: true,\n            status: \"Draw\",\n            hideButton: \"\"\n          });\n        }\n      } //update how many pieces left\n\n\n      this.setState({\n        white: white,\n        black: black\n      });\n    }\n  } //to determine if its possible to do en passant capture\n\n\n  enpassant(selectedPawnPosition) {\n    let enpassant = false;\n\n    if (selectedPawnPosition - 1 === this.state.lastTurnPawnPosition || selectedPawnPosition + 1 === this.state.lastTurnPawnPosition) {\n      if (this.state.firstMove) {\n        enpassant = true;\n      }\n    }\n\n    return enpassant;\n  } //dehighlight possible moves\n\n\n  dehighlight(squares) {\n    for (let index = 0; index < this.state.highLightMoves.length; index++) {\n      const element = this.state.highLightMoves[index];\n\n      if (squares[element].name === \"Pawn\" || squares[element].name === \"Knight\" || squares[element].name === \"Rook\" || squares[element].name === \"Bishop\" || squares[element].name === \"Queen\" || squares[element].name === \"King\") {\n        squares[element].style = { ...squares[element].style,\n          backgroundColor: \"\"\n        };\n      } else {\n        squares[element] = null;\n      }\n    }\n\n    return squares;\n  } //add captured piece to fallen soldier list\n\n\n  addToFallenSoldierList(i, squares, whiteFallenSoldiers, blackFallenSoldiers) {\n    if (squares[i] !== null) {\n      if (squares[i].player === 1) {\n        whiteFallenSoldiers.push(squares[i]);\n      } else if (squares[i].player === 2) {\n        blackFallenSoldiers.push(squares[i]);\n      }\n    }\n\n    this.setState({\n      whiteFallenSoldiers: whiteFallenSoldiers,\n      blackFallenSoldiers: blackFallenSoldiers\n    });\n  } //move player selected piece to target position\n\n\n  movePiece(i, squares, sourceSelection) {\n    squares[i] = squares[sourceSelection];\n    squares[sourceSelection] = null;\n    return squares;\n  }\n\n  changeTurn() {\n    let player = this.state.player === 1 ? 2 : 1;\n    let turn = this.state.turn === 'white' ? 'black' : 'white';\n    this.setState({\n      player: player,\n      turn: turn\n    });\n  } //display message, and reset chess board\n\n\n  wrongMove(squares, status) {\n    this.setState({\n      status: status,\n      sourceSelection: -1,\n      highLightMoves: [],\n      squares: squares\n    });\n  } //give it the current chess board and return the possible moves\n\n\n  allPossibleMovesWhite(squares) {\n    const allPossibleMovesWhite = [];\n\n    for (let i = 0; i < squares.length; i++) {\n      if (squares[i] !== null) {\n        if (squares[i].player === 1) {\n          if (squares[i].name === \"Pawn\") {\n            let tempArray = squares[i].possibleCaptureMoves(i, squares);\n\n            for (let i = 0; i < tempArray.length; i++) {\n              allPossibleMovesWhite.push(tempArray[i]);\n            }\n          } else {\n            let tempArray = squares[i].possibleMoves(i, squares);\n\n            for (let i = 0; i < tempArray.length; i++) {\n              allPossibleMovesWhite.push(tempArray[i]);\n            }\n          }\n        }\n      }\n    }\n\n    allPossibleMovesWhite.sort();\n    const result = [];\n\n    for (let i = 0; i < allPossibleMovesWhite.length; i++) {\n      if (allPossibleMovesWhite[i] !== allPossibleMovesWhite[i + 1]) {\n        result.push(allPossibleMovesWhite[i]);\n      }\n    }\n\n    return result;\n  }\n\n  allPossibleMovesBlack(squares) {\n    const allPossibleMovesBlack = [];\n\n    for (let i = 0; i < squares.length; i++) {\n      if (squares[i] !== null) {\n        if (squares[i].player === 2) {\n          if (squares[i].name === \"Pawn\") {\n            let tempArray = squares[i].possibleCaptureMoves(i, squares);\n\n            for (let i = 0; i < tempArray.length; i++) {\n              allPossibleMovesBlack.push(tempArray[i]);\n            }\n          } else {\n            let tempArray = squares[i].possibleMoves(i, squares);\n\n            for (let i = 0; i < tempArray.length; i++) {\n              allPossibleMovesBlack.push(tempArray[i]);\n            }\n          }\n        }\n      }\n    }\n\n    allPossibleMovesBlack.sort();\n    const temp = [];\n\n    for (let i = 0; i < allPossibleMovesBlack.length; i++) {\n      if (allPossibleMovesBlack[i] !== allPossibleMovesBlack[i + 1]) {\n        temp.push(allPossibleMovesBlack[i]);\n      }\n    }\n\n    return temp;\n  } //record king position\n\n\n  kingPosition(i) {\n    let whiteKingPosition = this.state.whiteKingPosition;\n    let blackKingPosition = this.state.blackKingPosition;\n\n    if (this.state.turn === \"white\") {\n      whiteKingPosition = i;\n    } else if (this.state.turn === \"black\") {\n      blackKingPosition = i;\n    }\n\n    this.setState({\n      whiteKingPosition: whiteKingPosition,\n      blackKingPosition: blackKingPosition\n    });\n  } //to check if selected piece can move or not, e.g., if they move seleced piece and it will end up in checkmate\n\n\n  checkMovesVer2(squares, highLightMoves, i, turn) {\n    const selectedPiece = i;\n    let king = false;\n\n    if (squares[selectedPiece].name === \"King\") {\n      king = true;\n    }\n\n    const newList = [];\n\n    for (let i = 0; i < highLightMoves.length; i++) {\n      let temp = squares.concat();\n      temp[highLightMoves[i]] = temp[selectedPiece];\n      temp[selectedPiece] = null;\n\n      if (!king) {\n        if (turn === \"white\") {\n          if (!this.allPossibleMovesBlack(temp).includes(this.state.whiteKingPosition)) {\n            newList.push(highLightMoves[i]);\n          }\n        } else if (turn === \"black\") {\n          if (!this.allPossibleMovesWhite(temp).includes(this.state.blackKingPosition)) {\n            newList.push(highLightMoves[i]);\n          }\n        }\n      } else if (king) {\n        if (turn === \"white\") {\n          if (!this.allPossibleMovesBlack(temp).includes(highLightMoves[i])) {\n            newList.push(highLightMoves[i]);\n          }\n        } else if (turn === \"black\") {\n          if (!this.allPossibleMovesWhite(temp).includes(highLightMoves[i])) {\n            newList.push(highLightMoves[i]);\n          }\n        }\n      }\n    }\n\n    return newList;\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"game\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"game-board\",\n          children: /*#__PURE__*/_jsxDEV(Board, {\n            squares: this.state.squares,\n            onClick: i => this.handleClick(i),\n            disabled: this.state.disabled\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 688,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 687,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"game-info\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Turn\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 695,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"player-turn-box\",\n            style: {\n              backgroundColor: this.state.turn\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 696,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"game-status\",\n            children: this.state.status\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 698,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"fallen-soldier-block\",\n            children: /*#__PURE__*/_jsxDEV(FallenSoldierBlock, {\n              whiteFallenSoldiers: this.state.whiteFallenSoldiers,\n              blackFallenSoldiers: this.state.blackFallenSoldiers\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 700,\n              columnNumber: 30\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 699,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: i => this.handleClick(i),\n            disabled: false,\n            style: {\n              display: this.state.hideButton\n            },\n            children: \"new game\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 706,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 694,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 686,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"icons-attribution\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [\" \", /*#__PURE__*/_jsxDEV(\"small\", {\n            children: [\" Chess Icons And Favicon (extracted) By en:User:Cburnett [\", /*#__PURE__*/_jsxDEV(\"a\", {\n              href: \"http://www.gnu.org/copyleft/fdl.html\",\n              children: \"GFDL\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 710,\n              columnNumber: 92\n            }, this), \", \", /*#__PURE__*/_jsxDEV(\"a\", {\n              href: \"http://creativecommons.org/licenses/by-sa/3.0/\",\n              children: \"CC-BY-SA-3.0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 710,\n              columnNumber: 149\n            }, this), \", \", /*#__PURE__*/_jsxDEV(\"a\", {\n              href: \"http://opensource.org/licenses/bsd-license.php\",\n              children: \"BSD\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 710,\n              columnNumber: 224\n            }, this), \" or \", /*#__PURE__*/_jsxDEV(\"a\", {\n              href: \"http://www.gnu.org/licenses/gpl.html\",\n              children: \"GPL\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 710,\n              columnNumber: 292\n            }, this), \"], \", /*#__PURE__*/_jsxDEV(\"a\", {\n              href: \"https://commons.wikimedia.org/wiki/Category:SVG_chess_pieces\",\n              children: \"via Wikimedia Commons\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 710,\n              columnNumber: 349\n            }, this), \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 710,\n            columnNumber: 27\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 710,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 709,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 685,\n      columnNumber: 13\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["/Users/terry/UUBC/React/Chess/src/components/game.js"],"names":["React","Board","FallenSoldierBlock","initialiseChessBoard","Queen","Knight","Bishop","Rook","Game","Component","constructor","state","squares","whiteFallenSoldiers","blackFallenSoldiers","player","sourceSelection","status","turn","white","black","lastTurnPawnPosition","undefined","firstMove","highLightMoves","allPossibleMovesWhite","allPossibleMovesBlack","whiteKingFirstMove","blackKingFirstMove","whiteRookFirstMoveLeft","whiteRookFirstMoveRight","blackRookFirstMoveLeft","blackRookFirstMoveRight","whiteKingPosition","blackKingPosition","tempSquares","convertPawnPosition","disabled","hideButton","handleClick","i","cancelable","setState","style","backgroundColor","some","element","includes","push","name","enpassant","checkMovesVer2","possibleMoves","concat","index","length","splice","newSquares","wrongMove","dehighlight","changeTurn","addToFallenSoldierList","movePiece","kingPosition","temp","temp2","console","log","selectedPawnPosition","tempArray","possibleCaptureMoves","sort","result","selectedPiece","king","newList","render","display"],"mappings":"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","sourcesContent":["/* eslint-disable no-unused-expressions */\nimport React from 'react';\nimport '../index.css';\nimport Board from './board.js';\nimport FallenSoldierBlock from './fallensoldiers';\nimport initialiseChessBoard from '../helpers/initialiseChessBoard';\nimport Queen from '../pieces/queen';\nimport Knight from '../pieces/knight';\nimport Bishop from '../pieces/bishop';\nimport Rook from '../pieces/rook';\n\nexport default class Game extends React.Component {\n    constructor() {\n        super();\n        this.state = {\n            squares: initialiseChessBoard(),\n            whiteFallenSoldiers: [],\n            blackFallenSoldiers: [],\n            player: 1,\n            sourceSelection: -1,\n            status: '',\n            turn: 'white',\n            white: 2,\n            black: 2,\n            lastTurnPawnPosition: undefined,\n            //firstMove true === last turn enemy's pawn moved for the first time and it moved 2 squares forward. for en pasaant\n            firstMove: undefined,\n            highLightMoves: [],\n            //for castle\n            allPossibleMovesWhite: [],\n            allPossibleMovesBlack: [],\n            whiteKingFirstMove: true,\n            blackKingFirstMove: true,\n            whiteRookFirstMoveLeft: true,\n            whiteRookFirstMoveRight: true,\n            blackRookFirstMoveLeft: true,\n            blackRookFirstMoveRight: true,\n            //record king's position\n            whiteKingPosition: 60,\n            blackKingPosition: 4,\n            //convert pawn\n            tempSquares: [],\n            convertPawnPosition: undefined,\n            //new game button\n            disabled: false,\n            hideButton: \"none\"\n        }\n    }\n\n    handleClick(i) {\n        let squares = this.state.squares;\n        let white = this.state.white;\n        let black = this.state.black;\n        if (i.cancelable) {\n            //reset game\n            this.setState({\n                squares: initialiseChessBoard(),\n                whiteFallenSoldiers: [],\n                blackFallenSoldiers: [],\n                player: 1,\n                sourceSelection: -1,\n                status: '',\n                turn: 'white',\n                white: 16,\n                black: 16,\n                lastTurnPawnPosition: undefined,\n                firstMove: undefined,\n                highLightMoves: [],\n                allPossibleMovesWhite: [],\n                allPossibleMovesBlack: [],\n                whiteKingFirstMove: true,\n                blackKingFirstMove: true,\n                whiteRookFirstMoveLeft: true,\n                whiteRookFirstMoveRight: true,\n                blackRookFirstMoveLeft: true,\n                blackRookFirstMoveRight: true,\n                whiteKingPosition: 60,\n                blackKingPosition: 4,\n                tempSquares: [],\n                convertPawnPosition: undefined,\n                disabled: false,\n                hideButton: \"none\"\n            });\n        } else if (this.state.sourceSelection === -1) {\n            let highLightMoves = [];\n            if (!squares[i] || squares[i].player !== this.state.player) {\n                this.setState({ status: \"Wrong selection. Choose player \" + this.state.player + \" pieces.\" });\n                squares[i] ? squares[i].style = { ...squares[i].style, backgroundColor: \"\" } : null;\n            } else {\n                //highlight selected piece\n                squares[i].style = { ...squares[i].style, backgroundColor: \"RGB(111,143,114)\" }; // Emerald from http://omgchess.blogspot.com/2015/09/chess-board-color-schemes.html\n                //check if castle is possible and add possible moves to highLightMoves array\n                if (i === 4 || i === 60) {\n                    if (this.state.turn === \"white\" && this.state.whiteKingFirstMove) {\n                        if (\n                            this.state.whiteRookFirstMoveLeft &&\n                            squares[57] === null &&\n                            squares[58] === null &&\n                            squares[59] === null &&\n                            !this.state.allPossibleMovesBlack.some(element => [57, 58, 59].includes(element))\n                        ) {\n                            highLightMoves.push(58);\n                        }\n                        if (\n                            this.state.whiteRookFirstMoveRight &&\n                            squares[61] === null &&\n                            squares[62] === null &&\n                            !this.state.allPossibleMovesBlack.some(element => [61, 62].includes(element))\n                        ) {\n                            highLightMoves.push(62);\n                        }\n                    } else if (this.state.turn === \"black\" && this.state.blackKingFirstMove) {\n                        if (\n                            this.state.blackRookFirstMoveLeft &&\n                            squares[1] === null &&\n                            squares[2] === null &&\n                            squares[3] === null &&\n                            !this.state.allPossibleMovesWhite.some(element => [1, 2, 3].includes(element))\n                        ) {\n                            highLightMoves.push(2);\n                        }\n                        if (\n                            this.state.blackRookFirstMoveRight &&\n                            squares[5] === null &&\n                            squares[6] === null &&\n                            !this.state.allPossibleMovesWhite.some(element => [5, 6].includes(element))\n                        ) {\n                            highLightMoves.push(6);\n                        }\n                    }\n                }\n                //highlight possible moves\n                if (squares[i].name === \"Pawn\") {\n                    const enpassant = this.enpassant(i);\n                    highLightMoves = this.checkMovesVer2(squares, squares[i].possibleMoves(i, squares, enpassant, this.state.lastTurnPawnPosition), i, this.state.turn);\n                } else if (squares[i].name === \"King\") {\n                    highLightMoves = highLightMoves.concat(squares[i].possibleMoves(i, squares));\n                    highLightMoves = this.checkMovesVer2(squares, highLightMoves, i, this.state.turn);\n\n                } else {\n                    highLightMoves = this.checkMovesVer2(squares, squares[i].possibleMoves(i, squares), i, this.state.turn);\n                }\n                for (let index = 0; index < highLightMoves.length; index++) {\n                    const element = highLightMoves[index];\n                    if (squares[element] !== null) {\n                        squares[element].style = { ...squares[element].style, backgroundColor: \"RGB(111,143,114)\" };\n                    } else {\n                        squares.splice(element, 1, { style: { backgroundColor: \"RGB(111,143,114)\" } });\n                    }\n                }\n                this.setState({\n                    squares: squares,\n                    status: \"Choose destination for the selected piece\",\n                    sourceSelection: i,\n                    highLightMoves: highLightMoves\n                });\n            }\n        } else if (this.state.sourceSelection === -2) {\n            //to convert pawn that reach other side of the chess board\n            if ([10, 11, 12, 13, 50, 51, 52, 53].includes(i)) {\n                //dehighlight\n                if (this.state.turn === \"black\") {\n                    squares[10].style = { ...squares[10].style, backgroundColor: \"\" };\n                    squares[11].style = { ...squares[11].style, backgroundColor: \"\" };\n                    squares[12].style = { ...squares[12].style, backgroundColor: \"\" };\n                    squares[13].style = { ...squares[13].style, backgroundColor: \"\" };\n                } else if (this.state.turn === \"white\") {\n                    squares[50].style = { ...squares[50].style, backgroundColor: \"\" };\n                    squares[51].style = { ...squares[51].style, backgroundColor: \"\" };\n                    squares[52].style = { ...squares[52].style, backgroundColor: \"\" };\n                    squares[53].style = { ...squares[53].style, backgroundColor: \"\" };\n                }\n                //convert pawn to player selected piece\n                const newSquares = this.state.tempSquares;\n                newSquares[this.state.convertPawnPosition] = squares[i];\n                this.setState({\n                    squares: newSquares,\n                    status: \"\",\n                    convertPawnPosition: undefined,\n                    sourceSelection: -1\n                })\n            } else {\n                this.wrongMove(squares, \"Wrong selection. Choose valid source and destination again.\")\n            }\n        } else if (this.state.sourceSelection > -1) {\n            //dehighlight selected piece\n            squares[this.state.sourceSelection].style = { ...squares[this.state.sourceSelection].style, backgroundColor: \"\" };\n\n            const whiteFallenSoldiers = this.state.whiteFallenSoldiers;\n            const blackFallenSoldiers = this.state.blackFallenSoldiers;\n\n            if (squares[this.state.sourceSelection].name === \"Pawn\") {\n                squares = this.dehighlight(squares);\n                const enpassant = this.enpassant(this.state.sourceSelection);\n                if (this.state.highLightMoves.includes(i)) {\n                    //if en passant is available and player decided to use it, else proceed without it\n                    if (enpassant && squares[i] == null && (this.state.lastTurnPawnPosition - 8 === i || this.state.lastTurnPawnPosition + 8 === i)) {\n                        //add captured piece to fallen soldier list\n                        if (squares[this.state.lastTurnPawnPosition].player === 1) {\n                            whiteFallenSoldiers.push(squares[this.state.lastTurnPawnPosition]);\n                            white = white - 1;\n                        }\n                        else {\n                            blackFallenSoldiers.push(squares[this.state.lastTurnPawnPosition]);\n                            black = black - 1;\n                        }\n                        //move player selected piece to target position\n                        squares[i] = squares[this.state.sourceSelection];\n                        squares[this.state.lastTurnPawnPosition] = null;\n                        squares[this.state.sourceSelection] = null;\n                        //update the possible moves in order to check if next player can castle or not\n                        const allPossibleMovesWhite = this.allPossibleMovesWhite(squares);\n                        const allPossibleMovesBlack = this.allPossibleMovesBlack(squares);\n                        this.changeTurn();\n                        this.setState({\n                            sourceSelection: -1,\n                            squares: squares,\n                            whiteFallenSoldiers: whiteFallenSoldiers,\n                            blackFallenSoldiers: blackFallenSoldiers,\n                            status: '',\n                            highLightMoves: [],\n                            allPossibleMovesWhite: allPossibleMovesWhite,\n                            allPossibleMovesBlack: allPossibleMovesBlack\n                        });\n                    } else {\n                        //check if current pawn is moving for the first time and moving 2 squares forward\n                        let firstMove;\n                        if (squares[this.state.sourceSelection].name === \"Pawn\") {\n                            if (squares[this.state.sourceSelection].player === 1 && i === this.state.sourceSelection - 16) {\n                                firstMove = true;\n                            } else if (squares[this.state.sourceSelection].player === 2 && i === this.state.sourceSelection + 16) {\n                                firstMove = true;\n                            }\n                        }\n                        //record current pawn position for next turn to check en passant rule\n                        let lastTurnPawnPosition = i;\n                        //update number of pieces\n                        if (squares[i] !== null) {\n                            if (this.state.turn === \"white\") {\n                                black = black - 1;\n                            } else {\n                                white = white - 1;\n                            }\n                        }\n                        this.addToFallenSoldierList(i, squares, whiteFallenSoldiers, blackFallenSoldiers);\n                        squares = this.movePiece(i, squares, this.state.sourceSelection);\n                        this.changeTurn();\n                        //update the possible moves in order to check if next player can castle or not\n                        const allPossibleMovesWhite = this.allPossibleMovesWhite(squares);\n                        const allPossibleMovesBlack = this.allPossibleMovesBlack(squares);\n                        //to convert pawn that reach other side of the chess board\n                        if ([0, 1, 2, 3, 4, 5, 6, 7, 56, 57, 58, 59, 60, 61, 62, 63].includes(i)) {\n                            const tempSquares = squares.concat();\n                            //give player choice to convert their pawn and highlight those choices\n                            if (this.state.turn === \"white\") {\n                                tempSquares[10] = new Knight(1);\n                                tempSquares[10].style = { ...tempSquares[10].style, backgroundColor: \"RGB(111,143,114)\" };\n                                tempSquares[11] = new Bishop(1);\n                                tempSquares[11].style = { ...tempSquares[11].style, backgroundColor: \"RGB(111,143,114)\" };\n                                tempSquares[12] = new Rook(1);\n                                tempSquares[12].style = { ...tempSquares[12].style, backgroundColor: \"RGB(111,143,114)\" };\n                                tempSquares[13] = new Queen(1);\n                                tempSquares[13].style = { ...tempSquares[13].style, backgroundColor: \"RGB(111,143,114)\" };\n                            } else if (this.state.turn === \"black\") {\n                                tempSquares[50] = new Knight(2);\n                                tempSquares[50].style = { ...tempSquares[50].style, backgroundColor: \"RGB(111,143,114)\" };\n                                tempSquares[51] = new Bishop(2);\n                                tempSquares[51].style = { ...tempSquares[51].style, backgroundColor: \"RGB(111,143,114)\" };\n                                tempSquares[52] = new Rook(2);\n                                tempSquares[52].style = { ...tempSquares[52].style, backgroundColor: \"RGB(111,143,114)\" };\n                                tempSquares[53] = new Queen(2);\n                                tempSquares[53].style = { ...tempSquares[53].style, backgroundColor: \"RGB(111,143,114)\" };\n                            }\n                            //update chess board with convert choices and save chess board without choices in this.state.tempSquares\n                            this.setState({\n                                sourceSelection: -2,\n                                tempSquares: squares,\n                                squares: tempSquares,\n                                status: \"\",\n                                highLightMoves: [],\n                                convertPawnPosition: i\n                            });\n                        } else {\n                            this.setState({\n                                sourceSelection: -1,\n                                squares: squares,\n                                status: \"\",\n                                firstMove: firstMove,\n                                lastTurnPawnPosition: lastTurnPawnPosition,\n                                highLightMoves: [],\n                                allPossibleMovesWhite: allPossibleMovesWhite,\n                                allPossibleMovesBlack: allPossibleMovesBlack\n                            });\n                        }\n                    }\n                } else {\n                    this.wrongMove(squares, \"Wrong selection. Choose valid source and destination again.\")\n                }\n            } else if (squares[this.state.sourceSelection].name === \"King\") {\n                squares = this.dehighlight(squares);\n                //for castling\n                if (this.state.highLightMoves.includes(i) && (i === 2 || i === 6 || i === 58 || i === 62) && (this.state.whiteKingFirstMove || this.state.blackKingFirstMove)) {\n                    if (i === 58) {\n                        squares = this.movePiece(i, squares, this.state.sourceSelection);\n                        squares = this.movePiece(59, squares, 56);\n                    }\n                    if (i === 62) {\n                        squares = this.movePiece(i, squares, this.state.sourceSelection);\n                        squares = this.movePiece(61, squares, 63);\n                    }\n                    if (i === 2) {\n                        squares = this.movePiece(i, squares, this.state.sourceSelection);\n                        squares = this.movePiece(3, squares, 0);\n                    }\n                    if (i === 6) {\n                        squares = this.movePiece(i, squares, this.state.sourceSelection);\n                        squares = this.movePiece(5, squares, 7);\n                    }\n                    //to record king has been moved or not. for castle\n                    let whiteKingFirstMove = this.state.whiteKingFirstMove;\n                    let blackKingFirstMove = this.state.blackKingFirstMove;\n                    if (squares[i].name === \"King\" && this.state.sourceSelection === 60 && squares[i].player === 1) {\n                        whiteKingFirstMove = false;\n                    }\n                    if (squares[i].name === \"King\" && this.state.sourceSelection === 4 && squares[i].player === 2) {\n                        blackKingFirstMove = false;\n                    }\n                    this.kingPosition(i);\n                    this.changeTurn();\n                    this.setState({\n                        sourceSelection: -1,\n                        squares: squares,\n                        status: '',\n                        highLightMoves: [],\n                        whiteKingFirstMove: whiteKingFirstMove,\n                        blackKingFirstMove: blackKingFirstMove\n                    });\n                } else if (this.state.highLightMoves.includes(i)) {\n                    //update number of pieces\n                    if (squares[i] !== null) {\n                        if (this.state.turn === \"white\") {\n                            black = black - 1;\n                        } else {\n                            white = white - 1;\n                        }\n                    }\n                    this.addToFallenSoldierList(i, squares, whiteFallenSoldiers, blackFallenSoldiers);\n                    squares = this.movePiece(i, squares, this.state.sourceSelection);\n                    this.kingPosition(i);\n                    this.changeTurn();\n                    //to record king has been moved or not. for castle\n                    let whiteKingFirstMove = this.state.whiteKingFirstMove;\n                    let blackKingFirstMove = this.state.blackKingFirstMove;\n                    if (squares[i].name === \"King\" && this.state.sourceSelection === 60 && squares[i].player === 1) {\n                        whiteKingFirstMove = false;\n                    }\n                    if (squares[i].name === \"King\" && this.state.sourceSelection === 4 && squares[i].player === 2) {\n                        blackKingFirstMove = false;\n                    }\n                    this.setState({\n                        sourceSelection: -1,\n                        squares: squares,\n                        status: '',\n                        highLightMoves: [],\n                        whiteKingFirstMove: whiteKingFirstMove,\n                        blackKingFirstMove: blackKingFirstMove\n                    });\n                } else {\n                    this.wrongMove(squares, \"Wrong selection. Choose valid source and destination again.\")\n                }\n            } else {\n                squares = this.dehighlight(squares);\n                if (this.state.highLightMoves.includes(i)) {\n                    //update number of pieces\n                    if (squares[i] !== null) {\n                        if (this.state.turn === \"white\") {\n                            black = black - 1;\n                        } else {\n                            white = white - 1;\n                        }\n                    }\n                    this.addToFallenSoldierList(i, squares, whiteFallenSoldiers, blackFallenSoldiers);\n                    squares = this.movePiece(i, squares, this.state.sourceSelection);\n                    this.changeTurn();\n                    //to record if rook has been moved or not. for castle.\n                    let whiteRookFirstMoveLeft = this.state.whiteRookFirstMoveLeft;\n                    let whiteRookFirstMoveRight = this.state.whiteRookFirstMoveRight;\n                    let blackRookFirstMoveLeft = this.state.blackRookFirstMoveLeft;\n                    let blackRookFirstMoveRight = this.state.blackRookFirstMoveRight;\n                    if (squares[i].name === \"Rook\" && this.state.sourceSelection === 56 && squares[i].player === 1) {\n                        whiteRookFirstMoveLeft = false;\n                    }\n                    if (squares[i].name === \"Rook\" && this.state.sourceSelection === 63 && squares[i].player === 1) {\n                        whiteRookFirstMoveRight = false;\n                    }\n                    if (squares[i].name === \"Rook\" && this.state.sourceSelection === 0 && squares[i].player === 2) {\n                        blackRookFirstMoveLeft = false;\n                    }\n                    if (squares[i].name === \"Rook\" && this.state.sourceSelection === 7 && squares[i].player === 2) {\n                        blackRookFirstMoveRight = false;\n                    }\n                    //update the possible moves in order to check if next player can castle or not\n                    const allPossibleMovesWhite = this.allPossibleMovesWhite(squares);\n                    const allPossibleMovesBlack = this.allPossibleMovesBlack(squares);\n                    this.setState({\n                        sourceSelection: -1,\n                        squares: squares,\n                        status: '',\n                        highLightMoves: [],\n                        whiteRookFirstMoveLeft: whiteRookFirstMoveLeft,\n                        whiteRookFirstMoveRight: whiteRookFirstMoveRight,\n                        blackRookFirstMoveLeft: blackRookFirstMoveLeft,\n                        blackRookFirstMoveRight: blackRookFirstMoveRight,\n                        allPossibleMovesWhite: allPossibleMovesWhite,\n                        allPossibleMovesBlack: allPossibleMovesBlack\n                    });\n                } else {\n                    this.wrongMove(squares, \"Wrong selection. Choose valid source and destination again.\")\n                }\n            }\n            //to record next player's possible moves\n            let temp = [];\n            const turn = this.state.turn === \"white\" ? \"black\" : \"white\";\n            const player = this.state.turn === \"white\" ? 2 : 1;\n            for (let i = 0; i < squares.length; i++) {\n                if (squares[i] !== null) {\n                    if (squares[i].player === player) {\n                        if (squares[i].name === \"Pawn\") {\n                            temp = temp.concat(this.checkMovesVer2(squares, squares[i].possibleMoves(i, squares), i, turn))\n                        } else if (squares[i].name === \"King\") {\n                            temp = temp.concat(this.checkMovesVer2(squares, squares[i].possibleMoves(i, squares), i, turn));\n                        } else {\n                            temp = temp.concat(this.checkMovesVer2(squares, squares[i].possibleMoves(i, squares), i, turn));\n                        }\n                    }\n                }\n            }\n            const kingPosition = turn === \"white\" ? this.state.whiteKingPosition : this.state.blackKingPosition;\n            //if next play doesn't have any possible moves then winner or stalemate\n            if (temp.length === 0) {\n                if (!squares[i].possibleMoves(i, squares).includes(kingPosition)) {\n                    this.setState({\n                        disabled: true,\n                        status: \"Stalemate Draw\",\n                        hideButton: \"\"\n                    });\n                } else {\n                    const status = turn === \"white\" ? \"Black Won\" : \"White Won\";\n                    this.setState({\n                        disabled: true,\n                        status: status,\n                        hideButton: \"\"\n                    });\n                }\n            }\n            //other ways to draw\n            if (black < 3 && white < 3) {\n                let temp = undefined;\n                let temp2 = false;\n                for (let i = 0; i < squares.length; i++) {\n                    if (squares[i] !== null) {\n                        if (squares[i].name === \"Bishop\") {\n                            if ([1, 3, 5, 7, 8, 10, 12, 14, 17, 19, 21, 23, 24, 26, 28, 30, 33, 35, 37, 39, 40, 42, 44, 46, 49, 51, 53, 55, 56, 58, 60, 62].includes(i)) {\n                                if (squares[i].player === 1) {\n                                    temp = true;\n                                } else {\n                                    temp2 = true;\n                                }\n                            } else {\n                                console.log(i)\n                                if (squares[i].player === 1) {\n                                    temp = false;\n                                } else {\n                                    temp2 = false;\n                                }\n                            }\n                        }\n                    }\n                }\n                //king and bishop versus king and bishop with the bishops on the same color\n                if (temp === temp2) {\n                    this.setState({\n                        disabled: true,\n                        status: \"Draw\",\n                        hideButton: \"\"\n                    });\n                }\n                console.log(black)\n                console.log(white)\n                //king versus king draw\n                if (black === white === 1) {\n                    this.setState({\n                        disabled: true,\n                        status: \"Draw\",\n                        hideButton: \"\"\n                    });\n                }\n            }\n            //update how many pieces left\n            this.setState({\n                white: white,\n                black: black\n            })\n        }\n    }\n\n    //to determine if its possible to do en passant capture\n    enpassant(selectedPawnPosition) {\n        let enpassant = false;\n        if (selectedPawnPosition - 1 === this.state.lastTurnPawnPosition || selectedPawnPosition + 1 === this.state.lastTurnPawnPosition) {\n            if (this.state.firstMove) {\n                enpassant = true;\n            }\n        }\n        return enpassant;\n    }\n\n    //dehighlight possible moves\n    dehighlight(squares) {\n        for (let index = 0; index < this.state.highLightMoves.length; index++) {\n            const element = this.state.highLightMoves[index];\n            if (squares[element].name === \"Pawn\" || squares[element].name === \"Knight\" || squares[element].name === \"Rook\" || squares[element].name === \"Bishop\" || squares[element].name === \"Queen\" || squares[element].name === \"King\") {\n                squares[element].style = { ...squares[element].style, backgroundColor: \"\" };\n            } else {\n                squares[element] = null;\n            }\n        }\n        return squares;\n    }\n\n    //add captured piece to fallen soldier list\n    addToFallenSoldierList(i, squares, whiteFallenSoldiers, blackFallenSoldiers) {\n        if (squares[i] !== null) {\n            if (squares[i].player === 1) {\n                whiteFallenSoldiers.push(squares[i]);\n            }\n            else if (squares[i].player === 2) {\n                blackFallenSoldiers.push(squares[i]);\n            }\n        }\n        this.setState({\n            whiteFallenSoldiers: whiteFallenSoldiers,\n            blackFallenSoldiers: blackFallenSoldiers\n        })\n    }\n\n    //move player selected piece to target position\n    movePiece(i, squares, sourceSelection) {\n        squares[i] = squares[sourceSelection];\n        squares[sourceSelection] = null;\n        return squares;\n    }\n\n    changeTurn() {\n        let player = this.state.player === 1 ? 2 : 1;\n        let turn = this.state.turn === 'white' ? 'black' : 'white';\n        this.setState({\n            player: player,\n            turn: turn\n        })\n    }\n\n    //display message, and reset chess board\n    wrongMove(squares, status) {\n        this.setState({\n            status: status,\n            sourceSelection: -1,\n            highLightMoves: [],\n            squares: squares\n        });\n    }\n\n    //give it the current chess board and return the possible moves\n    allPossibleMovesWhite(squares) {\n        const allPossibleMovesWhite = [];\n        for (let i = 0; i < squares.length; i++) {\n            if (squares[i] !== null) {\n                if (squares[i].player === 1) {\n                    if (squares[i].name === \"Pawn\") {\n                        let tempArray = squares[i].possibleCaptureMoves(i, squares);\n                        for (let i = 0; i < tempArray.length; i++) {\n                            allPossibleMovesWhite.push(tempArray[i]);\n                        }\n                    } else {\n                        let tempArray = squares[i].possibleMoves(i, squares);\n                        for (let i = 0; i < tempArray.length; i++) {\n                            allPossibleMovesWhite.push(tempArray[i]);\n                        }\n                    }\n                }\n            }\n        }\n        allPossibleMovesWhite.sort();\n        const result = [];\n        for (let i = 0; i < allPossibleMovesWhite.length; i++) {\n            if (allPossibleMovesWhite[i] !== allPossibleMovesWhite[i + 1]) {\n                result.push(allPossibleMovesWhite[i]);\n            }\n        }\n        return result;\n    }\n    allPossibleMovesBlack(squares) {\n        const allPossibleMovesBlack = [];\n        for (let i = 0; i < squares.length; i++) {\n            if (squares[i] !== null) {\n                if (squares[i].player === 2) {\n                    if (squares[i].name === \"Pawn\") {\n                        let tempArray = squares[i].possibleCaptureMoves(i, squares);\n                        for (let i = 0; i < tempArray.length; i++) {\n                            allPossibleMovesBlack.push(tempArray[i]);\n                        }\n                    } else {\n                        let tempArray = squares[i].possibleMoves(i, squares);\n                        for (let i = 0; i < tempArray.length; i++) {\n                            allPossibleMovesBlack.push(tempArray[i]);\n                        }\n                    }\n                }\n            }\n        }\n        allPossibleMovesBlack.sort();\n        const temp = [];\n        for (let i = 0; i < allPossibleMovesBlack.length; i++) {\n            if (allPossibleMovesBlack[i] !== allPossibleMovesBlack[i + 1]) {\n                temp.push(allPossibleMovesBlack[i]);\n            }\n        }\n        return temp;\n    }\n\n    //record king position\n    kingPosition(i) {\n        let whiteKingPosition = this.state.whiteKingPosition;\n        let blackKingPosition = this.state.blackKingPosition;\n        if (this.state.turn === \"white\") {\n            whiteKingPosition = i;\n        } else if (this.state.turn === \"black\") {\n            blackKingPosition = i;\n        }\n        this.setState({\n            whiteKingPosition: whiteKingPosition,\n            blackKingPosition: blackKingPosition\n        })\n    }\n\n    //to check if selected piece can move or not, e.g., if they move seleced piece and it will end up in checkmate\n    checkMovesVer2(squares, highLightMoves, i, turn) {\n        const selectedPiece = i;\n        let king = false;\n        if (squares[selectedPiece].name === \"King\") {\n            king = true;\n        }\n        const newList = [];\n        for (let i = 0; i < highLightMoves.length; i++) {\n            let temp = squares.concat();\n            temp[highLightMoves[i]] = temp[selectedPiece];\n            temp[selectedPiece] = null;\n            if (!king) {\n                if (turn === \"white\") {\n                    if (!this.allPossibleMovesBlack(temp).includes(this.state.whiteKingPosition)) {\n                        newList.push(highLightMoves[i]);\n                    }\n                } else if (turn === \"black\") {\n                    if (!this.allPossibleMovesWhite(temp).includes(this.state.blackKingPosition)) {\n                        newList.push(highLightMoves[i]);\n                    }\n                }\n            } else if (king) {\n                if (turn === \"white\") {\n                    if (!this.allPossibleMovesBlack(temp).includes(highLightMoves[i])) {\n                        newList.push(highLightMoves[i]);\n                    }\n                } else if (turn === \"black\") {\n                    if (!this.allPossibleMovesWhite(temp).includes(highLightMoves[i])) {\n                        newList.push(highLightMoves[i]);\n                    }\n                }\n            }\n        }\n        return newList;\n    }\n\n    render() {\n        return (\n            <div>\n                <div className=\"game\">\n                    <div className=\"game-board\">\n                        <Board\n                            squares={this.state.squares}\n                            onClick={(i) => this.handleClick(i)}\n                            disabled={this.state.disabled}\n                        />\n                    </div>\n                    <div className=\"game-info\">\n                        <h3>Turn</h3>\n                        <div id=\"player-turn-box\" style={{ backgroundColor: this.state.turn }}>\n                        </div>\n                        <div className=\"game-status\">{this.state.status}</div>\n                        <div className=\"fallen-soldier-block\">\n                            {<FallenSoldierBlock\n                                whiteFallenSoldiers={this.state.whiteFallenSoldiers}\n                                blackFallenSoldiers={this.state.blackFallenSoldiers}\n                            />\n                            }\n                        </div>\n                        <button onClick={(i) => this.handleClick(i)} disabled={false} style={{ display: this.state.hideButton }}>new game</button>\n                    </div>\n                </div>\n                <div className=\"icons-attribution\">\n                    <div> <small> Chess Icons And Favicon (extracted) By en:User:Cburnett [<a href=\"http://www.gnu.org/copyleft/fdl.html\">GFDL</a>, <a href=\"http://creativecommons.org/licenses/by-sa/3.0/\">CC-BY-SA-3.0</a>, <a href=\"http://opensource.org/licenses/bsd-license.php\">BSD</a> or <a href=\"http://www.gnu.org/licenses/gpl.html\">GPL</a>], <a href=\"https://commons.wikimedia.org/wiki/Category:SVG_chess_pieces\">via Wikimedia Commons</a> </small></div>\n                </div>\n            </div>\n        );\n    }\n}"]},"metadata":{},"sourceType":"module"}